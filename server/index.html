<!DOCTYPE html>
<html>
<head>
  <title>Buy Bitcoin</title>
  <meta charset="utf-8">
      <script>
        var xhr = new XMLHttpRequest();
        var url = "cgi-bin/get_info.py";
        xhr.open("GET", url, true);
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var resp = JSON.parse(xhr.responseText);
				if (resp.new_order == true) {
					document.getElementById("next_order_time").textContent = "次の定期購入まで残り " + resp.remain;
				} else {
					document.getElementById("next_order_time").innerHTML = '<a href="/cgi-bin/enable_new_order.py">定期購入を開始</a>';
				}
				document.getElementById("hostname").textContent = resp.hostname;
            }
        };
        xhr.send();
    </script>
</head>
<body>
  <h1>Buy Bitcoin</h1>
  <p id="next_order_time">loading...</p>
  <form method="post" action="/cgi-bin/spot_order.py">
    <input type="number" name="purchase">
    <input type="submit" value="スポット購入">
  </form>
  <form method="get" action="/cgi-bin/balance.py">
    <input type="submit" value="サマリー">
  </form>
  <form method="get" action="/cgi-bin/history.py">
    <input type="submit" value="取引履歴">
  </form>
  <a href="api_key.html">APIキー</a>
  <a href="/cgi-bin/backup.py" target="_blank">バックアップ</a>
  <a href="restore.html" target="_blank">復元</a>
  <p id="hostname"></p>
</body>
</html>
